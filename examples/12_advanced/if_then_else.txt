// ============================================================================
// Example: Conditional Expressions (if-then-else)
// ============================================================================
// Demonstrates:
//   - if-then-else expression syntax
//   - Conditional expressions in function definitions
//   - Nested conditionals
//   - Conditional expressions in pattern matching
//   - Boolean guard patterns
//
// Features:
//   - if condition then expr1 else expr2
//   - Nested if-then-else
//   - Conditionals in axdef/gendef
//   - Pattern matching with conditions
//
// See: docs/USER_GUIDE.md - Section "Advanced Features" > "Conditional Expressions"
// ============================================================================

=== Conditional Expressions ===

** Example 1: Basic If-Then-Else **

TEXT: The if-then-else expression evaluates to one of two values based on a condition:

if x > 0 then 1 else -1

TEXT: If x is positive, this evaluates to 1; otherwise, it evaluates to -1.

** Example 2: Absolute Value Function **

axdef
  abs : Z -> N
where
  forall x : Z | abs(x) = if x >= 0 then x else -x
end

TEXT: The absolute value function uses if-then-else to handle positive and negative cases.

** Example 3: Maximum Function **

axdef
  maximum : N cross N -> N
where
  forall a, b : N | maximum(a, b) = if a >= b then a else b
end

TEXT: Returns the larger of two numbers.

** Example 4: Sign Function **

axdef
  sign : Z -> {-1, 0, 1}
where
  forall x : Z |
    sign(x) = if x > 0 then 1
              else if x = 0 then 0
              else -1
end

TEXT: Nested if-then-else for three-way branching.

** Example 5: Conditional elem Set Comprehension **

{ x : N | x < 10 . if x mod 2 = 0 then x else x + 1 }

TEXT: For each x less than 10, select x if it's even, otherwise select x + 1.

** Example 6: Pattern Matching with Conditionals **

axdef
  filterPositives : seq Z -> seq Z
where
  filterPositives(⟨⟩) = ⟨⟩
  forall x : Z; s : seq Z |
    filterPositives(⟨x⟩ ⌢ s) =
      if x > 0 \
        then ⟨x⟩ ⌢ filterPositives(s) \
        else filterPositives(s)
end

TEXT: Filters a sequence to include only positive elements using conditional expressions.

** Example 7: Grade Assignment **

Grade ::= GradeA | GradeB | GradeC | GradeD | GradeF

axdef
  scoreToGrade : N -> Grade
where
  forall score : N |
    scoreToGrade(score) =
      if score >= 90 then GradeA \
      else if score >= 80 then GradeB \
      else if score >= 70 then GradeC \
      else if score >= 60 then GradeD \
      else GradeF
end

TEXT: Multi-way branching using nested if-then-else.

** Example 8: Piecewise Function **

axdef
  piecewise : Z -> Z
where
  forall x : Z |
    piecewise(x) = if x < -5 then 0
                   else if x < 0 then x + 5
                   else if x < 5 then x
                   else if x < 10 then x - 5
                   else 0
end

TEXT: A piecewise-defined function with multiple ranges.

** Example 9: Conditional elem Lambda **

lambda x : N . if x > 100 then 100 else x

TEXT: Lambda function that caps values at 100.

** Example 10: Conditional Set Selection **

axdef
  evenSet : P N
  oddSet : P N
where
  evenSet = {n : N | n mod 2 = 0}
  oddSet = {n : N | n mod 2 = 1}
end

TEXT: Define sets that can be selected conditionally in expressions.

** Example 11: Practical Example - Tax Rate Selection **

axdef
  taxRate : N -> N
where
  forall income : N |
    taxRate(income) = if income < 20000 then 10
                      else if income < 50000 then 15
                      else if income < 100000 then 20
                      else 25
end

TEXT: Progressive tax rates with multi-level conditional.

** Example 12: Conditional with Complex Expression **

axdef
  complexFunc : N -> N
where
  forall n : N |
    complexFunc(n) = if n mod 3 = 0 then n * n
                     else if n mod 3 = 1 then n + 10
                     else n * 2
end

TEXT: Different computations based on remainder.

** Example 13: Guard Conditions elem Recursion **

axdef
  factorial : N -> N
where
  factorial(0) = 1
  forall n : N |
    factorial(n) = if n > 0 then n * factorial(n - 1) else 1
end

TEXT: Conditional ensures factorial only recurses for positive n.

** Example 14: Ternary-Style Expression **

TEXT: Z notation's if-then-else is similar to C's ternary operator (? :):

TEXT: C: x > 0 ? 1 : -1
TEXT: Z: if x > 0 then 1 else -1

TEXT: Both evaluate to one of two values based on a condition.

** Example 15: Short-Circuit Evaluation Note **

TEXT: In Z notation, if-then-else expressions should be evaluated lazily: only the selected branch should be evaluated. This matters when branches have side effects or may be undefined.

TEXT: If a key is not in a function's domain, accessing it would be undefined. A conditional ensures we only evaluate the function application when it's safe.

** Example 16: Best Practices **

TEXT: When using if-then-else:
TEXT: 1. Keep branches simple and readable
TEXT: 2. For many cases, consider using free types with pattern matching
TEXT: 3. Nest carefully—deep nesting hurts readability
TEXT: 4. Document complex conditions
TEXT: 5. Ensure both branches have the same type
TEXT: 6. Consider using helper predicates for complex conditions
